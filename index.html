<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>HTML5 Photo Editor</title>
    <link rel="stylesheet" href="css/main.css">
    <script src="/lib/jquery-1.11.1.min.js" type="text/javascript"></script>
      
      <style>
        canvas{
            border: 2px solid brown;
            margin- top: 10px;
        }
      </style>
  </head>
  <body>
      <div class="toolbar">
      
      </div>
      
      <img id="img" src="images/vegetables.jpg" style="display:none">
      
      <canvas id="canvas" width="500" height="500" 
              style="background-image:URL('/images/vegetables.jpg')">
        Please get a better browser.  Anything latest of chrome, firefox, ie should work.
      </canvas>
      
      <canvas id="canvas2" width="500" height="500" >
      
      </canvas>
      
      
      <script>
      
          var started = false;
          var x = 100, y = 100, w = 30, h = 30;
          
          function init(){
            canvas = document.getElementById("canvas");
            ctx = canvas.getContext('2d');
              
            canvas2 = document.getElementById("canvas2");
            ctx2 = canvas2.getContext('2d');
              
            img = document.getElementById("img");
            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
            ctx.strokeRect(x - w/2, y-h/2, w, h);
              
            
            canvas.addEventListener('mousemove', ev_move);
            canvas.addEventListener('mousedown', ev_down);
            canvas.addEventListener('mouseup', ev_up);
            
             
          }
          
          function ev_down(ev){
            if (!ev) { ev = event;}
            ev.preventDefault();
              
            xc = ev.layerX; yc = ev.layerY;
              
            if ((xc >= x-w/2) && (xc <= (x + w/2)) &&
                (yc >= y - h/2) && (yc <= (y + h/2))){
            
                started = true;
                ev_move();
            }
          }
          
          
          function ev_move(ev){
            if (!ev) { ev = event;}
            ev.preventDefault();
              
            if (started){
                xc = ev.layerX; 
                yc = ev.layerY;
                
            }
            else{
                return;  
            }
              
            x = xc;
            y = yc;
              
            canvas.width = canvas.width;
              
            ctx.strokeRect(x - w/2, y - h/2, w, h);
              
            ctx2.drawImage(img, x, y, w, h, 0,0, canvas2.width, canvas2.height);
              
          }
          
          function ev_up(ev){
            started = false;
          }
          
          
          init();
          
          
      </script>
  </body>
</html>
